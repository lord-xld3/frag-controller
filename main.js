(()=>{"use strict";(()=>{function e(e,n){return{bind:()=>{n.down&&e.addEventListener("pointerdown",n.down),n.move&&e.addEventListener("pointermove",n.move),n.up&&(e.addEventListener("pointerup",n.up),e.addEventListener("pointercancel",n.up),e.addEventListener("pointerout",n.up),e.addEventListener("pointerleave",n.up)),n.wheel&&e.addEventListener("wheel",n.wheel,{passive:!1})},unbind:()=>{n.down&&e.removeEventListener("pointerdown",n.down),n.move&&e.removeEventListener("pointermove",n.move),n.up&&(e.removeEventListener("pointerup",n.up),e.removeEventListener("pointercancel",n.up),e.removeEventListener("pointerout",n.up),e.removeEventListener("pointerleave",n.up)),n.wheel&&e.removeEventListener("wheel",n.wheel)}}}function n(e,n,t=0,o=1,i=0,r=1,a="control"){const s=Object.assign(document.createElement("div"),{className:a}),c=Object.assign(document.createElement("label"),{textContent:n}),l=Object.assign(document.createElement("input"),{type:"range",id:n,name:n,step:o.toString(),min:i.toString(),max:r.toString(),value:t.toString()}),u=Object.assign(document.createElement("span"),{className:"tooltip",id:`${n}-tooltip`,textContent:t.toString()});return c.setAttribute("for",n),l.addEventListener("input",(()=>{u.textContent=l.value})),s.append(c,l,u),e.appendChild(s),l}function t(n,t){const o=n.getContext("webgl2",t);if(!o)throw new Error("WebGL2 is not supported");const i=n instanceof HTMLCanvasElement?function(e=n.clientWidth,t=n.clientHeight,i=0,r=0){n.width=e,n.height=t,o.viewport(i,r,e,t)}:function(e=n.width,t=n.height){n.width=e,n.height=t,o.viewport(0,0,e,t)};return[o,{resize:i,newProgram:a,useSSQ:function(e){const n=a("#version 300 es\nin vec2 a;void main(){gl_Position=vec4(a,0,1);}",e);o.useProgram(n);const t=o.getAttribLocation(n,"a");return o.bindBuffer(o.ARRAY_BUFFER,o.createBuffer()),o.bufferData(o.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),o.STATIC_DRAW),o.enableVertexAttribArray(t),o.vertexAttribPointer(t,2,o.FLOAT,!1,0,0),n},drawSSQ:function(){o.drawArrays(o.TRIANGLES,0,6)},bindUniformBlock:s,baseStream:function(t,o,r=0,a=1){const c=s(t,o,r);let l=2/n.clientHeight*window.devicePixelRatio,u=[],d=a,m=0,v=0,f=Math.exp(-d),p=0;function w(e,n){c.set(new Uint32Array([e,n]),0)}function h(e,n){c.set(new Uint32Array([e,n]),8)}function g(e,n){m=e,v=n,c.set(new Float32Array([e,n]),16)}function A(e){d=e,f=Math.exp(-e),c.set(new Float32Array([e]),28)}return[c,Object.assign(Object.assign({},e(n,{down:e=>{u.push(e),1===u.length&&n.setPointerCapture(e.pointerId),w(e.clientX,e.clientY)},up:e=>{u=u.filter((n=>n.pointerId!==e.pointerId)),u.length<2&&(p=0),n.releasePointerCapture(e.pointerId)},move:e=>{let n=u.findIndex((n=>n.pointerId===e.pointerId));if(u[n]=e,1===u.length&&(w(e.clientX,e.clientY),g(m-=e.movementX*l*f,v+=e.movementY*l*f)),2===u.length&&e.isPrimary){const[e,n]=u,t=Math.hypot(e.clientX-n.clientX,e.clientY-n.clientY);p&&A(d+=(t-p)*l),p=t}},wheel:e=>{e.preventDefault(),A(d-=e.deltaY*l)}})),{setCoords:w,setResolution:h,setDelta:g,setTime:function(e){c.set(new Float32Array([e]),24)},setZoom:A,scaleToDevice:(e=window.devicePixelRatio,t=n.clientWidth,o=n.clientHeight)=>{t=Math.round(t*e),o=Math.round(o*e),l=2/o*e,i(t,o),h(t,o)}})]}}];function r(e,n){const t=o.createShader(e);if(o.shaderSource(t,n),o.compileShader(t),!o.getShaderParameter(t,o.COMPILE_STATUS))throw new Error(o.getShaderInfoLog(t));return t}function a(e,n){const t=o.createProgram(),i=r(o.VERTEX_SHADER,e),a=r(o.FRAGMENT_SHADER,n);if(o.attachShader(t,i),o.attachShader(t,a),o.linkProgram(t),!o.getProgramParameter(t,o.LINK_STATUS))throw new Error(o.getProgramInfoLog(t));return t}function s(e,n,t=0,i=o.STATIC_DRAW){const r=o.getUniformBlockIndex(e,n);r===o.INVALID_INDEX&&console.warn("Uniform block ",n," not found in program:",e),c(t);const a=function(e,n){const t=o.createBuffer();return t||console.warn("Failed to create BufferObject."),{buf:t,bind:()=>o.bindBuffer(e,t),unbind:()=>o.bindBuffer(e,null),delete:()=>o.deleteBuffer(t),setBuffer:t=>o.bufferData(e,t,n)}}(o.UNIFORM_BUFFER,i),s=new ArrayBuffer(o.getActiveUniformBlockParameter(e,r,o.UNIFORM_BLOCK_DATA_SIZE));return u(),{delete:a.delete,bindBlock:c,bind:l,unbind:function(){o.bindBufferBase(o.UNIFORM_BUFFER,r,null),a.unbind()},set:function(e,n=0,t=0,o=e.length){new e.constructor(s,n,o).set(e,t)},update:u};function c(n){o.uniformBlockBinding(e,r,n)}function l(){a.bind(),o.bindBufferBase(o.UNIFORM_BUFFER,r,a.buf)}function u(){l(),a.setBuffer(s)}}}!function(){const[e,n]=t(document.getElementById("background")),o=n.useSSQ("#version 300 es\n    precision highp float;\n    precision highp int;\n\n    #define f gl_FragCoord.xy\n\n    uniform I { uvec2 iMouse, iResolution; vec2 iDelta; float iTime, iZoom; };\n\n    out vec4 o;\n\n    void main() {\n        vec2 uv = f / vec2(iResolution);\n        vec2 center = uv - 0.5;\n        float dist = length(center);\n        float angle = atan(center.y, center.x);\n        float wave = sin(iTime + dist * 10.0 + angle * 5.0);\n\n        // Define black edges\n        float edge = smoothstep(0.4, 0.5, abs(sin(wave * 10.0)));\n        vec3 color = 0.5 + 0.5 * cos(2.0 * wave + vec3(0.0, 2.0, 4.0) + iTime);\n        color = color * (1.0 - edge); // Apply edges\n\n        o = vec4(color, 1.0);\n    }"),[i,r]=n.baseStream(o,"I");function a(t){e.clear(e.COLOR_BUFFER_BIT),r.setTime(.001*t),i.update(),n.drawSSQ(),requestAnimationFrame(a)}r.bind(),window.onresize=()=>{r.scaleToDevice(),requestAnimationFrame(a)},window.dispatchEvent(new Event("resize")),e.useProgram(o),e.clearColor(0,0,0,1),requestAnimationFrame(a)}(),function(){const o=document.getElementById("canvas"),[i,r]=t(o),a=r.useSSQ("#version 300 es\n    precision highp float;\n    precision highp int;\n\n    #define f gl_FragCoord.xy\n\n    uniform I { uvec2 iMouse, iResolution; vec2 iDelta; float iTime, iZoom; };\n\n    uniform U { uvec2 J; vec2 E; vec3 C; };\n\n    out vec4 o;\n\n    const float Y = 12.;\n\n    void main() {\n        vec2 r = vec2(iResolution);\n        float W = 1./(exp(iZoom)*r.y), F = E.y * W + E.x, K = float(J.y - J.x);\n        vec2 n = (2.*f - r)*W + iDelta, p = n, z = n*n;\n        int i = 0, H = int(K * pow(iZoom/Y, 2.)) + int(J.x);\n        while (i < H && z.x < F) { n = vec2(z.x - z.y + p.x, 2.*n.x*n.y + p.y); z = n*n; ++i; }\n        o = (i < H) ? vec4(.5 + .5 * cos(4. + (float(i) + 1. - log2(log2(dot(n, n)) / log2(F))) * .1 + C), 1) : vec4(0, 0, 0, 1);\n    }");let s=window.devicePixelRatio,c=!1;const l=document.getElementById("mandelbrot"),u=document.getElementById("panel"),d=n(u,"Resolution scale",s,s/2,s/2,2*s),m=n(u,"Zoom",.01,1e-4,-1,12),v=n(u,"Min Iterations",80,1,1,400),f=n(u,"Max Iterations",400,1,80,1e3),p=n(u,"Min Escape Radius",6,1e-4,2,10),w=n(u,"Max Escape Radius",5e3,1e-4,6,1e4),h=n(u,"Hue",.6,1e-4,0,1);l.ondblclick=e=>{e.preventDefault(),u.style.display="none"===u.style.display?"flex":"none"};let g=0;e(window,{down:()=>{c=!0,3==++g&&(u.style.display="none"===u.style.display?"flex":"none"),requestAnimationFrame(y)},up:()=>{c=!1,g=0},wheel:()=>{requestAnimationFrame(y)}}).bind();const[A,b]=r.baseStream(a,"I",0,.01);b.bind(),b.setCoords(-.75,0),b.setDelta(-.75,0),window.onresize=()=>{b.scaleToDevice(s),requestAnimationFrame(y)},window.dispatchEvent(new Event("resize")),A.update();const E=r.bindUniformBlock(a,"U",1);E.set(new Uint32Array([80,400])),E.set(new Float32Array([6,5e3,Math.cos(.6*Math.PI*2),Math.cos(.6*Math.PI*2+1),Math.cos(.6*Math.PI*2+2)]),8),E.update(),d.oninput=()=>{s=d.valueAsNumber,b.scaleToDevice(s)},m.oninput=()=>{b.setZoom(m.valueAsNumber)},v.oninput=()=>{f.min=v.value,E.set(new Uint32Array([v.valueAsNumber]),0)},f.oninput=()=>{v.max=f.value,E.set(new Uint32Array([f.valueAsNumber]),4)},p.oninput=()=>{w.min=p.value,E.set(new Float32Array([p.valueAsNumber]),8)},w.oninput=()=>{E.set(new Float32Array([w.valueAsNumber]),12)},h.oninput=()=>{const e=h.valueAsNumber*Math.PI*2;E.set(new Float32Array([Math.cos(e),Math.cos(e+1),Math.cos(e+2)]),16)};const F=document.getElementById("fullscreen");function y(){i.clear(i.COLOR_BUFFER_BIT),E.update(),A.update(),r.drawSSQ(),c&&requestAnimationFrame(y)}F.onclick=()=>{document.fullscreenElement?(document.exitFullscreen(),F.value="ðŸ”³"):(l.requestFullscreen(),F.value="ðŸ”²")},i.useProgram(a),i.clearColor(0,0,0,1),requestAnimationFrame(y)}()})()})();