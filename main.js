(()=>{"use strict";(()=>{function e(e,n=(()=>{}),t=(()=>{}),o=(()=>{}),i=(()=>{})){return{bind:()=>{e.addEventListener("pointerdown",n),e.addEventListener("pointermove",o),e.addEventListener("pointerup",t),e.addEventListener("pointercancel",t),e.addEventListener("pointerout",t),e.addEventListener("pointerleave",t),e.addEventListener("wheel",i,{passive:!0})},unbind:()=>{e.removeEventListener("pointerdown",n),e.removeEventListener("pointermove",o),e.removeEventListener("pointerup",t),e.removeEventListener("pointercancel",t),e.removeEventListener("pointerout",t),e.removeEventListener("pointerleave",t),e.removeEventListener("wheel",i)}}}function n(e,n,t=0,o=1,i=0,r=1,a="control"){const s=Object.assign(document.createElement("div"),{className:a}),c=Object.assign(document.createElement("label"),{textContent:n}),l=Object.assign(document.createElement("input"),{type:"range",id:n,name:n,step:o.toString(),min:i.toString(),max:r.toString(),value:t.toString()}),u=Object.assign(document.createElement("span"),{className:"tooltip",id:`${n}-tooltip`,textContent:t.toString()});return c.setAttribute("for",n),l.addEventListener("input",(()=>{u.textContent=l.value})),s.append(c,l,u),e.appendChild(s),l}const t=document.getElementById("canvas"),[o,i]=function(n,t){const o=n.getContext("webgl2",t);if(!o)throw new Error("WebGL2 is not supported");const i=n instanceof HTMLCanvasElement?function(e=n.clientWidth,t=n.clientHeight,i=0,r=0){n.width=e,n.height=t,o.viewport(i,r,e,t)}:function(e=n.width,t=n.height){n.width=e,n.height=t,o.viewport(0,0,e,t)};return[o,{resize:i,newProgram:a,useSSQ:function(e){const n=a("#version 300 es\nin vec2 a;void main(){gl_Position=vec4(a,0,1);}",e);o.useProgram(n);const t=o.getAttribLocation(n,"a");return o.bindBuffer(o.ARRAY_BUFFER,o.createBuffer()),o.bufferData(o.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),o.STATIC_DRAW),o.enableVertexAttribArray(t),o.vertexAttribPointer(t,2,o.FLOAT,!1,0,0),n},drawSSQ:function(){o.drawArrays(o.TRIANGLES,0,6)},bindUniformBlock:s,baseStream:function(t,o,r=0,a=1){const c=s(t,o,r);let l=1/n.clientHeight,u=[],d=a,m=0,f=0,v=Math.exp(-d),p=0;function h(e,n){c.set(new Uint32Array([e,n]),0)}function g(e,n){c.set(new Uint32Array([e,n]),8)}function w(e,n){m=e,f=n,c.set(new Float32Array([e,n]),16)}function E(e){d=e,v=Math.exp(-e),c.set(new Float32Array([e]),28)}return[c,Object.assign(Object.assign({},e(n,(e=>{u.push(e),1===u.length&&n.setPointerCapture(e.pointerId),h(e.clientX,e.clientY)}),(e=>{u=u.filter((n=>n.pointerId!==e.pointerId)),u.length<2&&(p=0),n.releasePointerCapture(e.pointerId)}),(e=>{let n=u.findIndex((n=>n.pointerId===e.pointerId));if(u[n]=e,1===u.length&&(h(e.clientX,e.clientY),w(m-=e.movementX*l*v*2,f+=e.movementY*l*v*2)),2===u.length&&e.isPrimary){const[e,n]=u,t=Math.hypot(e.clientX-n.clientX,e.clientY-n.clientY);p&&E(d+=(t-p)*l*4),p=t}}),(e=>E(d-=e.deltaY*l)))),{setCoords:h,setResolution:g,setDelta:w,setTime:function(e){c.set(new Float32Array([e]),24)},setZoom:E,scaleToDevice:(e=window.devicePixelRatio,t=n.clientWidth,o=n.clientHeight)=>{t=Math.round(t*e),o=Math.round(o*e),i(t,o),g(t,o)}})]}}];function r(e,n){const t=o.createShader(e);if(o.shaderSource(t,n),o.compileShader(t),!o.getShaderParameter(t,o.COMPILE_STATUS))throw new Error(o.getShaderInfoLog(t));return t}function a(e,n){const t=o.createProgram(),i=r(o.VERTEX_SHADER,e),a=r(o.FRAGMENT_SHADER,n);if(o.attachShader(t,i),o.attachShader(t,a),o.linkProgram(t),!o.getProgramParameter(t,o.LINK_STATUS))throw new Error(o.getProgramInfoLog(t));return t}function s(e,n,t=0,i=o.STATIC_DRAW){const r=o.getUniformBlockIndex(e,n);r===o.INVALID_INDEX&&console.warn("Uniform block ",n," not found in program:",e),c(t);const a=function(e,n){const t=o.createBuffer();return t||console.warn("Failed to create BufferObject."),{buf:t,bind:()=>o.bindBuffer(e,t),unbind:()=>o.bindBuffer(e,null),delete:()=>o.deleteBuffer(t),setBuffer:t=>o.bufferData(e,t,n)}}(o.UNIFORM_BUFFER,i),s=new ArrayBuffer(o.getActiveUniformBlockParameter(e,r,o.UNIFORM_BLOCK_DATA_SIZE));return u(),{delete:a.delete,bindBlock:c,bind:l,unbind:function(){o.bindBufferBase(o.UNIFORM_BUFFER,r,null),a.unbind()},set:function(e,n=0,t=0,o=e.length){new e.constructor(s,n,o).set(e,t)},update:u};function c(n){o.uniformBlockBinding(e,r,n)}function l(){a.bind(),o.bindBufferBase(o.UNIFORM_BUFFER,r,a.buf)}function u(){l(),a.setBuffer(s)}}}(t),r=i.useSSQ("#version 300 es\nprecision highp float;\nprecision highp int;\n\n#define f gl_FragCoord.xy\n\nuniform I { uvec2 iMouse, iResolution; vec2 iDelta; float iTime, iZoom; };\n\nuniform U { uvec2 J; vec2 E; vec3 C; };\n\nout vec4 o;\n\nconst float Y = 12.;\n\nvoid main() {\n    vec2 r = vec2(iResolution);\n    float W = 1./(exp(iZoom)*r.y), F = E.y * W + E.x, K = float(J.y - J.x);\n    vec2 n = (2.*f - r)*W + iDelta, p = n, z = n*n;\n    int i = 0, H = int(K * pow(iZoom/Y, 2.)) + int(J.x);\n    while (i < H && z.x < F) { n = vec2(z.x - z.y + p.x, 2.*n.x*n.y + p.y); z = n*n; ++i; }\n    o = (i < H) ? vec4(.5 + .5 * cos(4. + (float(i) + 1. - log2(log2(dot(n, n)) / log2(F))) * .1 + C), 1) : vec4(0);\n}");let a=window.devicePixelRatio;const s=document.getElementById("panel"),c=n(s,"Resolution scale",a,a/4,a/4,2*a),l=n(s,"Zoom",.01,1e-4,-1,12),u=n(s,"Min Iterations",80,1,1,400),d=n(s,"Max Iterations",400,1,80,1e3),m=n(s,"Min Escape Radius",6,1e-4,0,10),f=n(s,"Max Escape Radius",5e3,1e-4,6,1e4),v=n(s,"Hue",.6,1e-4,0,1);window.ondblclick=()=>{s.style.display="none"===s.style.display?"flex":"none"};let p=0;e(window,(()=>{3==++p&&(s.style.display="none"===s.style.display?"flex":"none")}),(()=>{p=0})).bind();const[h,g]=i.baseStream(r,"I",0,.01);g.bind(),g.setCoords(-.75,0),g.setDelta(-.75,0),window.onresize=()=>{g.scaleToDevice(a)},window.dispatchEvent(new Event("resize")),h.update();const w=i.bindUniformBlock(r,"U",1);w.set(new Uint32Array([80,400])),w.set(new Float32Array([6,5e3,Math.cos(.6*Math.PI*2),Math.cos(.6*Math.PI*2+1),Math.cos(.6*Math.PI*2+2)]),8),w.update(),c.oninput=()=>{a=c.valueAsNumber,g.scaleToDevice(a)},l.oninput=()=>{g.setZoom(l.valueAsNumber)},u.oninput=()=>{d.min=u.value,w.set(new Uint32Array([u.valueAsNumber]),0)},d.oninput=()=>{u.max=d.value,w.set(new Uint32Array([d.valueAsNumber]),4)},m.oninput=()=>{f.min=m.value,w.set(new Float32Array([m.valueAsNumber]),8)},f.oninput=()=>{w.set(new Float32Array([f.valueAsNumber]),12)},v.oninput=()=>{const e=v.valueAsNumber*Math.PI*2;w.set(new Float32Array([Math.cos(e),Math.cos(e+1),Math.cos(e+2)]),16)};const E=document.getElementById("fullscreen");E.onclick=()=>{document.fullscreenElement?(document.exitFullscreen(),E.value="ðŸ”³"):(document.documentElement.requestFullscreen(),E.value="ðŸ”²")},o.useProgram(r),o.clearColor(0,0,0,1),requestAnimationFrame((function e(){o.clear(o.COLOR_BUFFER_BIT),w.update(),h.update(),i.drawSSQ(),requestAnimationFrame(e)}))})()})();